<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Zenith – Simple Web Language</title>
  <style>
    :root {
      --bg: #0f172a;
      --text: #e2e8f0;
      --accent: #6366f1;
      --accent-hover: #818cf8;
      --editor-bg: #111827;
    }
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family: system-ui, sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      overflow: hidden;
    }
    header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: rgba(15,23,42,0.9);
      backdrop-filter: blur(12px);
      padding: 1rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      z-index: 1000;
    }
    .logo { font-size: 1.8rem; font-weight: bold; }
    .actions button {
      margin-left: 0.8rem;
      padding: 0.7rem 1.4rem;
      background: var(--accent);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.2s;
    }
    .actions button:hover { background: var(--accent-hover); transform: translateY(-2px); }
    #preview-container {
      height: 100vh;
      width: 100vw;
      overflow: hidden;
    }
    #previewFrame {
      width: 100%;
      height: 100%;
      border: none;
      display: block;
    }
    #editor-overlay {
      position: fixed;
      inset: 0;
      background: var(--editor-bg);
      color: var(--text);
      transform: translateX(100%);
      transition: transform 0.4s ease;
      z-index: 2000;
      display: flex;
      flex-direction: column;
      padding: 5rem 1.5rem 1.5rem;
    }
    #editor-overlay.open { transform: translateX(0); }
    #close-editor {
      position: absolute;
      top: 1rem;
      right: 1.5rem;
      background: transparent;
      border: none;
      color: white;
      font-size: 2.4rem;
      cursor: pointer;
    }
    textarea {
      flex: 1;
      background: #0f172a;
      color: #e2e8f0;
      font-family: monospace;
      font-size: 15px;
      padding: 1.2rem;
      border: 1px solid #334155;
      border-radius: 10px;
      resize: none;
      outline: none;
      line-height: 1.5;
    }
    .error-message {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: #f87171;
      font-size: 1.4rem;
      text-align: center;
      background: rgba(0,0,0,0.7);
      padding: 2rem;
      border-radius: 12px;
      max-width: 90%;
    }
  </style>
</head>
<body>
  <header>
    <div class="logo">Zenith</div>
    <div class="actions">
      <button onclick="toggleEditor()">Edit Code</button>
      <button onclick="downloadHTML()">Download HTML</button>
      <button onclick="downloadCSS()">Download CSS</button>
    </div>
  </header>

  <div id="preview-container">
    <iframe id="previewFrame" scrolling="yes"></iframe>
    <div id="errorOverlay" class="error-message" style="display:none;">
      Start your Zenith code with <strong>zen</strong> on the first line!
    </div>
  </div>

  <div id="editor-overlay">
    <button id="close-editor" onclick="toggleEditor()">×</button>
    <h2 style="margin-bottom:1rem; color:white;">Zenith Code Editor</h2>
    <p style="color:#94a3b8; margin-bottom:1.5rem;">Start with <code>zen</code> on line 1. Build beautiful sites!</p>
    <textarea id="zenInput">
zen
@hero
STACK
  NAV
    LINK "Home" / #
    LINK "Menu" / #menu
    LINK "Events" / #events
    LINK "Book a Table" / #booking

  TITLE "The Rusty Anchor" / giant / bold / #2c1810 / center
  TEXT "Fresh pints, hearty food, and good company since 1987" / large / normal / #4a2c1a / center
  BUTTON "See the Menu" / huge / bold / white / center / #8b4513

  IMAGE "https://images.unsplash.com/photo-1516684666992-8e1d8d3a1b9a?w=1600" / Cozy pub interior with warm lights / 100%

@welcome
STACK
  TITLE "Welcome to the Anchor" / big / bold / #3c2a1e / center
  TEXT "Your local spot for craft beers, homemade pies, and live music every Friday." / normal / #5c4033 / center

@menu
STACK
  TITLE "What's on Tap & on the Plate" / bold / #3c2a1e / center

  GRID
    CARD
      SUBTITLE "Classic Fish & Chips"
      TEXT "Beer-battered cod, thick-cut chips, mushy peas. £14.50"
    CARD
    CARD
      SUBTITLE "Sunday Roast"
      TEXT "Roast beef or chicken, Yorkshire pudding, all the trimmings. £16.95"
    CARD

@events
STACK
  TITLE "Live Music & Events" / bold / #3c2a1e / center
  TEXT "Every Friday night – local bands from 8pm" / normal / #5c4033 / center
  BUTTON "See Full Calendar" / bold / white / center / #8b4513

@booking
STACK
  TITLE "Book a Table" / big / bold / #3c2a1e / center
  TEXT "Walk-ins welcome, but reservations recommended on weekends." / normal / #5c4033 / center
  BUTTON "Reserve Now" / huge / bold / white / center / #a0522d

@footer
  COPYRIGHT "© 2026 The Rusty Anchor – All rights served"
  TEXT "123 Harbour Lane | Old Port Town | 01632 960 123 | info@rustyanchor.pub"
    </textarea>
  </div>

  <script>
    const editorOverlay = document.getElementById('editor-overlay');
    const previewFrame = document.getElementById('previewFrame');
    const errorOverlay = document.getElementById('errorOverlay');

    function toggleEditor() {
      editorOverlay.classList.toggle('open');
    }

    function zenithToHtml(zenCode) {
      let html = `<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Your Zenith Website</title>
  <style>
    html, body { height:100%; margin:0; }
    body { 
      font-family:system-ui, sans-serif; 
      background:linear-gradient(to bottom, #f8fafc, #e2e8f0); 
      color:#0f172a; 
      display:flex; 
      flex-direction:column; 
      min-height:100vh; 
    }
    main { flex:1 0 auto; padding-bottom:2rem; }
    footer { 
      flex-shrink:0; 
      background:#0f172a; 
      color:#94a3b8; 
      text-align:center; 
      padding:4rem 2rem; 
      font-size:0.95rem; 
    }
    .stack { display:flex; flex-direction:column; gap:3rem; padding:6rem 4rem; align-items:center; text-align:center; }
    .grid { display:grid; grid-template-columns:repeat(auto-fit, minmax(320px, 1fr)); gap:2.5rem; padding:3rem 2rem; }
    .card { background:white; border-radius:16px; padding:2.5rem; box-shadow:0 10px 40px rgba(0,0,0,0.12); transition:transform 0.3s ease; }
    .card:hover { transform:translateY(-8px); }
    .btn { display:inline-block; padding:1.1rem 2.8rem; background:#6366f1; color:white; border:none; border-radius:10px; font-weight:600; cursor:pointer; transition:all 0.25s ease; }
    .btn:hover { background:#818cf8; transform:translateY(-3px); }
    nav { background:#0f172a; color:white; padding:1.2rem 4rem; position:sticky; top:0; z-index:1000; backdrop-filter:blur(10px); }
    nav ul { display:flex; gap:3rem; list-style:none; margin:0; padding:0; justify-content:center; flex-wrap:wrap; }
    nav a { color:#e2e8f0; text-decoration:none; font-weight:600; transition:color 0.2s; }
    nav a:hover { color:#c7d2fe; }
    img { max-width:100%; height:auto; border-radius:16px; display:block; margin:2rem auto; box-shadow:0 10px 30px rgba(0,0,0,0.15); }
    h1 { font-size:4rem; margin:0; letter-spacing:-1px; }
    h3 { font-size:2.2rem; margin:0 0 1rem; }
    p { max-width:75ch; margin:0 auto; font-size:1.15rem; }
    section { padding:5rem 3rem; }
    @media (max-width:768px) { 
      .stack, .grid { padding:4rem 1.8rem; } 
      .grid { grid-template-columns:1fr; } 
      nav ul { gap:1.5rem; } 
      h1 { font-size:3rem; } 
    }
  </style>
</head>
<body>
<main>`;

      const lines = zenCode.split('\n').map(l => l.trim()).filter(Boolean);
      let containerStack = [];
      let inFooter = false;

      lines.forEach(line => {
        if (line.startsWith('@')) {
          const sectionType = line.slice(1).trim().toLowerCase();
          if (sectionType === 'footer') {
            // Close all open containers before footer
            while (containerStack.length > 0) {
              const tag = containerStack.pop();
              if (tag === 'nav') html += '</ul></nav>';
              else if (tag === 'footer') html += '</footer>';
              else html += '</div>';
            }
            inFooter = true;
            html += '<footer>';
            return; // don't add section tag for footer
          } else {
            html += '<section>';
          }
        }

        if (line === 'STACK') {
          containerStack.push('div');
          html += '<div class="stack">';
        }
        if (line === 'GRID') {
          containerStack.push('div');
          html += '<div class="grid">';
        }
        if (line === 'CARD') {
          containerStack.push('div');
          html += '<div class="card">';
        }
        if (line === 'NAV') {
          containerStack.push('nav');
          html += '<nav><ul>';
        }

        if (line.startsWith('TITLE ')) {
          const parts = line.slice(6).split('/').map(p => p.trim().replace(/"/g,''));
          html += `<h1 style="font-weight:${parts[1]||'normal'}; color:${parts[3]||'#0f172a'}; text-align:${parts[4]||'center'};">${parts[0]}</h1>`;
        }
        if (line.startsWith('TEXT ')) {
          const parts = line.slice(5).split('/').map(p => p.trim().replace(/"/g,''));
          html += `<p style="color:${parts[3]||'#475569'};">${parts[0]}</p>`;
        }
        if (line.startsWith('BUTTON ')) {
          const parts = line.slice(7).split('/').map(p => p.trim().replace(/"/g,''));
          const bg = parts[4] ? `background:${parts[4]};` : 'background:#6366f1;';
          html += `<button class="btn" style="${bg}">${parts[0]}</button>`;
        }
        if (line.startsWith('SUBTITLE ')) {
          html += `<h3>${line.slice(9).trim().replace(/"/g,'')}</h3>`;
        }
        if (line.startsWith('IMAGE ')) {
          const parts = line.slice(6).split('/').map(p => p.trim().replace(/"/g,''));
          html += `<img src="${parts[0]}" alt="${parts[1]||'Image'}" style="max-width:${parts[2]||'100%'};">`;
        }
        if (line.startsWith('LINK ')) {
          const parts = line.slice(5).split('/').map(p => p.trim().replace(/"/g,''));
          html += `<li><a href="${parts[1]||'#'}">${parts[0]}</a></li>`;
        }
        if (line.startsWith('COPYRIGHT ')) {
          html += `<p>${line.slice(10).trim().replace(/"/g,'')}</p>`;
        }
      });

      // Close remaining containers
      while (containerStack.length > 0) {
        const tag = containerStack.pop();
        if (tag === 'nav') html += '</ul></nav>';
        else if (tag === 'footer') html += '</footer>';
        else html += '</div>';
      }

      html += '</main></body></html>';
      return html;
    }

    function renderPreview() {
      const code = document.getElementById('zenInput').value.trim();
      const lines = code.split('\n').map(l => l.trim()).filter(Boolean);
      const firstLine = lines[0] ? lines[0].toLowerCase() : '';

      if (!firstLine.startsWith('zen')) {
        document.getElementById('errorOverlay').style.display = 'block';
        document.getElementById('previewFrame').srcdoc = '';
      } else {
        document.getElementById('errorOverlay').style.display = 'none';
        const cleanCode = lines.slice(1).join('\n');
        document.getElementById('previewFrame').srcdoc = zenithToHtml(cleanCode);
      }
    }

    function downloadHTML() {
      const code = document.getElementById('zenInput').value.trim();
      const lines = code.split('\n').map(l => l.trim()).filter(Boolean);
      if (!lines[0]?.toLowerCase().startsWith('zen')) {
        alert("Start with 'zen' on the first line!");
        return;
      }
      const cleanCode = lines.slice(1).join('\n');
      const fullHtml = zenithToHtml(cleanCode);

      const dataUri = 'data:text/html;charset=utf-8,' + encodeURIComponent(fullHtml);
      const a = document.createElement('a');
      a.href = dataUri;
      a.download = 'my-zenith-site.html';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
    }

    function downloadCSS() {
      const cssMatch = zenithToHtml('').match(/<style>([\s\S]*?)<\/style>/);
      const css = cssMatch ? cssMatch[1].trim() : '';
      if (!css) {
        alert("No CSS generated yet. Try rendering first!");
        return;
      }

      const dataUri = 'data:text/css;charset=utf-8,' + encodeURIComponent(css);
      const a = document.createElement('a');
      a.href = dataUri;
      a.download = 'zenith-styles.css';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
    }

    document.getElementById('zenInput').addEventListener('input', renderPreview);
    renderPreview(); // Initial load
  </script>
</body>
</html>